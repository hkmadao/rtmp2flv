{"version":3,"sources":["conf/env.js","api/AxiosConf.js","api/Api.js","camera/Play.js","camera/CameraEdit.js","camera/ActionList.js","camera/CameraList.js","camerashare/CopyAlert.js","camerashare/CameraShareEdit.js","camerashare/ActionList.js","camerashare/CameraShareList.js","login/SignInSide.js","404/NoMatch.js","camera/Live.js","route/Routing.js","Rtmp2flv.js","index.js"],"names":["serverURL","window","location","origin","axios","defaults","withCredentials","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","err","console","error","Promise","reject","response","data","errcode","parseInt","hash","isCancel","log","status","setItem","alert","String","toLowerCase","substring","Env","POST","url","params","post","then","res","GET","get","API","id","useStyles","makeStyles","theme","appBar","position","backgroundColor","title","marginLeft","spacing","flex","videoContainer","width","margin","Transition","React","forwardRef","props","ref","_jsx","Slide","direction","Play","classes","open","setOpen","useState","audio","setAudio","playParam","setPlayParam","playMethod","cameraCode","authCode","player","lastDecodedFrame","useImperativeHandle","onRef","handleClickOpen","handleClose","flv_load","val","mediaDataSource","type","videoUrl","flv_load_mds","element","document","getElementsByClassName","pause","unload","detachMediaElement","destroy","Flv","createPlayer","enableWorker","lazyLoadMaxDuration","seekType","on","Events","ERROR","errorType","errorDetail","errorInfo","setTimeout","STATISTICS_INFO","decodedFrames","attachMediaElement","load","play","children","_jsxs","Dialog","fullScreen","onClose","TransitionComponent","AppBar","className","Toolbar","Button","variant","onClick","Typography","Switch","checked","color","name","onChange","event","target","inputProps","autoFocus","CloseIcon","controls","allow","formClass","formDiv","CameraEdit","enabled","setEnabled","row","saveVideo","setSaveVideo","live","setLive","setRow","code","rtmpAuthCode","playAuthCode","onlineStatus","alertShow","setAlertShow","alertText","setAlertText","save","callBack","msg","formChange","value","switchChange","Alert","severity","AlertTitle","noValidate","autoComplete","onSubmit","TextField","label","InputProps","readOnly","defaultValue","root","dropdown","top","right","left","zIndex","border","padding","ActionList","saveVideoChange","liveChange","playRef","createRef","editRef","ClickAwayListener","onClickAway","handleClickAway","handleClick","prev","ListIcon","style","display","flexDirection","gap","current","NavLink","exact","to","pathname","search","state","playAuthcodeReset","columns","minWidth","format","LinkIcon","LinkOffIcon","container","minHeight","CameraList","page","setPage","rowsPerPage","setRowsPerPage","rows","setRows","getPageList","splice","push","useEffect","Paper","TableContainer","Table","stickyHeader","TableHead","TableRow","map","column","TableCell","align","TableBody","slice","hover","role","tabIndex","TablePagination","rowsPerPageOptions","component","count","length","onChangePage","handleChangePage","newPage","onChangeRowsPerPage","CopyAlert","setTitle","dialog","content","setContent","DialogTitle","DialogContent","DialogContentText","DialogActions","CameraShareEdit","cameraId","startTime","Moment","deadline","add","formDateTimeChange","InputLabelProps","shrink","dialogObj","setDialogObj","copyRef","List","ListItem","button","ListItemText","primary","sURL","Copy","Date","getTimezoneOffset","camera","CameraShareList","editRow","setEditRow","setCamera","reg","RegExp","r","substr","match","decodeURIComponent","getQueryString","editRowNew","Copyright","Link","href","getFullYear","height","image","backgroundImage","backgroundRepeat","palette","grey","backgroundSize","backgroundPosition","paper","alignItems","avatar","secondary","main","form","marginTop","submit","SignInSide","user","setUser","userName","password","onLoad","Grid","CssBaseline","item","xs","sm","md","elevation","square","Avatar","LockOutlinedIcon","required","fullWidth","FormControlLabel","control","Checkbox","Box","mt","Component","render","method","Routing","Route","path","Live","NoMatch","memo","Rtmp2flv","HashRouter","App","ReactDOM","querySelector"],"mappings":"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","file":"static/js/main.672abc9b.chunk.js","sourcesContent":["let env = process.env.NODE_ENV\r\nlet serverURL\r\n \r\nif (env === 'development') {\r\n    serverURL = \"http://127.0.0.1:9090\"\r\n} else if (env === 'production') {\r\n    serverURL = window.location.origin\r\n}\r\n\r\nexport default {serverURL:serverURL}","import Env from '../conf/env';\r\nimport axios from 'axios'\r\n\r\n\r\naxios.defaults.withCredentials = false;\r\n\r\naxios.defaults.timeout = 10000;\r\n\r\naxios.interceptors.request.use(config => {\r\n  let token = window.localStorage.getItem(\"token\")\r\n  config.headers.token = token\r\n  return config;\r\n}, err => {\r\n  console.error(err);\r\n  return Promise.reject(err);\r\n});\r\n\r\naxios.interceptors.response.use(function (response) {\r\n  if (response.data && response.data.errcode) {\r\n    if (parseInt(response.data.errcode) === 401) {\r\n      //nologin\r\n      window.location.hash = \"#/login\"\r\n    }\r\n  }\r\n  return response;\r\n}, function (error) {\r\n  if (axios.isCancel()) {\r\n    return Promise.reject(error);\r\n  } else {\r\n    if (error.response) {\r\n      console.log(error.response.status === 401)\r\n      if (error.response.status === 401) {\r\n        if (!window.localStorage.getItem(\"token\") || !window.localStorage.getItem(\"tokenExpired\") || window.localStorage.getItem(\"tokenExpired\") === \"false\") { \r\n          window.localStorage.setItem(\"tokenExpired\", \"true\");\r\n          window.location.hash = \"#/login\"\r\n        }\r\n      } else if (error.response.status === 500) {\r\n        alert(\"server exception !\")\r\n      }\r\n    } else if (error && String(error).toLowerCase().substring(0, 14) === \"error: timeout\") {\r\n      alert(\"server timeout !\")\r\n    }else{\r\n      alert(\"server error !\")\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n});\r\n\r\nlet serverURL = Env.serverURL;\r\n\r\nexport const POST = (url, params) => {\r\n  return axios.post(`${serverURL}${url}`, params).then(res => res.data)\r\n}\r\nexport const GET = (url, params) => {\r\n  return axios.get(`${serverURL}${url}`, {\r\n    params: params\r\n  }).then(res => res.data)\r\n}\r\n\r\nexport const PUT = (url, params) => {\r\n  return axios.put(`${serverURL}${url}`, params).then(res => res.data)\r\n}\r\n\r\nexport const DELETE = (url, params) => {\r\n  return axios.delete(`${serverURL}${url}`, {\r\n    params: params\r\n  }).then(res => res.data)\r\n}\r\n\r\nexport const PATCH = (url, params) => {\r\n  return axios.patch(`${serverURL}${url}`, params).then(res => res.data)\r\n}\r\n"," import Env from '../conf/env';\r\n import * as API from './AxiosConf'\r\n \r\n let serverURL = Env.serverURL;\r\n export default {\r\n    flvURL: `${serverURL}`,\r\n    login: (params) => {\r\n        return API.POST(`/system/login`,params)\r\n    },\r\n    cameraList: (params) => {\r\n        return API.GET(`/camera/list`,params)\r\n    },\r\n    cameraDetail: (params) => {\r\n        return API.GET(`/camera/detail`,params)\r\n    },\r\n    cameraEdit: (params) => {\r\n        return API.POST(`/camera/edit`,params)\r\n    },\r\n    cameraDelete: (params) => {\r\n        return API.POST(`/camera/delete/${params.id}`,params)\r\n    },\r\n    cameraEnabled: (params) => {\r\n        return API.POST(`/camera/enabled`,params)\r\n    },\r\n    cameraSaveVideoChange: (params) => {\r\n        return API.POST(`/camera/savevideochange`,params)\r\n    },\r\n    cameraLiveChange: (params) => {\r\n        return API.POST(`/camera/livechange`,params)\r\n    },\r\n    cameraPlayAuthcodeReset: (params) => {\r\n        return API.POST(`/camera/playauthcodereset`,params)\r\n    },\r\n    cameraShareList: (params) => {\r\n        return API.GET(`/camerashare/list`,params)\r\n    },\r\n    cameraShareEdit: (params) => {\r\n        return API.POST(`/camerashare/edit`,params)\r\n    },\r\n    cameraShareDelete: (params) => {\r\n        return API.POST(`/camerashare/delete/${params.id}`,params)\r\n    },\r\n    cameraShareEnabled: (params) => {\r\n        return API.POST(`/camerashare/enabled`,params)\r\n    },\r\n }\r\n ","import React, { useImperativeHandle } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport Flv from 'flv.js';\r\nimport API from '../api/Api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: 'relative',\r\n    backgroundColor: '#eebbaa',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n  videoContainer: {\r\n    width: '90%',\r\n    margin: '0 auto'\r\n  },\r\n}));\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport default function Play(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [audio, setAudio] = React.useState(true);\r\n  const [playParam, setPlayParam] = React.useState(props.playParam || {\r\n    playMethod: \"\",\r\n    cameraCode: \"\",\r\n    authCode: \"\"\r\n  });\r\n  var player = null;\r\n  var lastDecodedFrame = 0\r\n\r\n  const switchChange = (event) => {\r\n    setAudio(event.target.checked)\r\n  }\r\n\r\n  //用useImperativeHandle暴露一些外部ref能访问的属性\r\n  useImperativeHandle(props.onRef, () => {\r\n    return {\r\n      handleClickOpen: handleClickOpen,\r\n    };\r\n  });\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const flv_load = (val) => {\r\n      var mediaDataSource = {\r\n          type: 'flv'\r\n      };\r\n      let videoUrl = API.flvURL+\"/live/\"+playParam.playMethod+\"/\"+playParam.cameraCode+\"/\"+playParam.authCode+\".flv\";\r\n      mediaDataSource['url'] = videoUrl;\r\n      mediaDataSource['hasAudio'] = audio;\r\n      mediaDataSource['isLive'] = true;\r\n      console.log('MediaDataSource', mediaDataSource);\r\n      flv_load_mds(mediaDataSource);\r\n  }\r\n\r\n  const flv_load_mds = (mediaDataSource) => {\r\n      var element = document.getElementsByClassName('centeredVideo')[0];\r\n    \r\n      if (typeof player !== \"undefined\") {\r\n          if (player != null) {\r\n            player.pause();\r\n            player.unload();\r\n            player.detachMediaElement();\r\n            player.destroy();\r\n            player= null;\r\n          }\r\n      }\r\n      \r\n      player = Flv.createPlayer(mediaDataSource, {\r\n          enableWorker: false,\r\n          lazyLoadMaxDuration: 3 * 60,\r\n          seekType: 'range',\r\n      });\r\n      player.on(Flv.Events.ERROR, (errorType, errorDetail, errorInfo) => {\r\n        console.log(\"errorType:\", errorType);\r\n        console.log(\"errorDetail:\", errorDetail);\r\n        console.log(\"errorInfo:\", errorInfo);\r\n        //视频出错后销毁重新创建\r\n        if (player) {\r\n          player.pause();\r\n          player.unload();\r\n          player.detachMediaElement();\r\n          player.destroy();\r\n          player= null;\r\n          window.setTimeout(flv_load,500)\r\n        }\r\n      });\r\n      //画面卡死\r\n      player.on(Flv.Events.STATISTICS_INFO, function (res) {\r\n        if (lastDecodedFrame == 0) {\r\n          lastDecodedFrame = res.decodedFrames;\r\n          return;\r\n        }\r\n        if (lastDecodedFrame != res.decodedFrames) {\r\n          lastDecodedFrame = res.decodedFrames;\r\n        } else {\r\n            console.log(\"decodedFrames:\", res.decodedFrames)\r\n            lastDecodedFrame = 0;\r\n            if (player) {\r\n              player.pause();\r\n              player.unload();\r\n              player.detachMediaElement();\r\n              player.destroy();\r\n              player= null;\r\n              window.setTimeout(flv_load,500)\r\n          }\r\n        }\r\n      });\r\n      player.attachMediaElement(element);\r\n      player.load();\r\n      player.play()\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Dialog fullScreen open={open} onClose={handleClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar}>\r\n          <Toolbar>\r\n            <Button variant=\"contained\" onClick={flv_load}>\r\n              play\r\n            </Button>\r\n            <Typography variant=\"h6\" className={classes.title}>\r\n            hasAudio\r\n              <Switch\r\n                checked={audio}\r\n                id=\"Audio\"\r\n                color=\"primary\"\r\n                name=\"hasAudio\"\r\n                onChange={switchChange}\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n              />\r\n            </Typography>\r\n            <Button autoFocus color=\"inherit\" onClick={handleClose}>\r\n              <CloseIcon />\r\n            </Button>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <div className={classes.videoContainer}>\r\n            <div>\r\n                <video name=\"videoElement\" className=\"centeredVideo\" controls allow=\"autoPlay\" width=\"100%\" >\r\n                    Your browser is too old which doesn't support HTML5 video.\r\n                </video>\r\n            </div>\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useImperativeHandle } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport { Alert, AlertTitle } from '@material-ui/lab';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport API from '../api/Api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n  formClass: {\r\n    '& > *': {\r\n      margin: theme.spacing(1),\r\n      width: '25ch',\r\n    },\r\n  },\r\n  formDiv: {\r\n    margin: '0 auto',\r\n  },\r\n}));\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport default function CameraEdit(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [enabled, setEnabled] = React.useState(props.row.enabled === 1?true:false);\r\n  const [saveVideo, setSaveVideo] = React.useState(props.row.saveVideo === 1?true:false);\r\n  const [live, setLive] = React.useState(props.row.live === 1?true:false);\r\n  const [row, setRow] = React.useState({\r\n    id: props.row.id,\r\n    code: props.row.code,\r\n    rtmpAuthCode: props.row.rtmpAuthCode,\r\n    playAuthCode: props.row.playAuthCode,\r\n    onlineStatus: props.row.onlineStatus,\r\n    enabled: props.row.enabled,\r\n    saveVideo: props.row.saveVideo,\r\n    live: props.row.live,\r\n  });\r\n  const [alertShow, setAlertShow] = React.useState(false);\r\n  const [alertText, setAlertText] = React.useState(\"\");\r\n\r\n  //用useImperativeHandle暴露一些外部ref能访问的属性\r\n  useImperativeHandle(props.onRef, () => {\r\n    return {\r\n      handleClickOpen: handleClickOpen,\r\n    };\r\n  });\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const save = (data) => {\r\n    API.cameraEdit(row)\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack){\r\n          props.callBack()\r\n        }\r\n        return;\r\n      }\r\n      setAlertText(res.msg);\r\n      setAlertShow(true);\r\n      window.setTimeout(function (){\r\n        setAlertShow(false);\r\n      },5000)\r\n    });\r\n  };\r\n\r\n  const deleteCamera = (data) => {\r\n    API.cameraDelete(row)\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack){\r\n          props.callBack()\r\n        }\r\n        return;\r\n      }\r\n      setAlertText(res.msg);\r\n      setAlertShow(true);\r\n      window.setTimeout(function (){\r\n        setAlertShow(false);\r\n      },5000)\r\n    });\r\n  };\r\n\r\n  const formChange = (event) => {\r\n    row[event.target.id] = event.target.value\r\n  }\r\n\r\n  const switchChange = (event) => {\r\n    console.log(event.target.checked)\r\n    row[event.target.id] = event.target.checked?1:0\r\n    if(event.target.id===\"enabled\"){\r\n      setEnabled(event.target.checked)\r\n    }\r\n    if(event.target.id===\"saveVideo\"){\r\n      setSaveVideo(event.target.checked)\r\n    }\r\n    if(event.target.id===\"live\"){\r\n      setLive(event.target.checked)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Dialog fullScreen open={open} onClose={handleClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar}>\r\n          <Toolbar>\r\n            <Button variant=\"contained\" onClick={save}>\r\n              保存\r\n            </Button>\r\n            <span>&nbsp;&nbsp;</span>\r\n            {props.type === 'edit'?\r\n              <Button variant=\"contained\" onClick={deleteCamera}>\r\n                删除\r\n              </Button>:\"\"\r\n            }       \r\n            <Typography variant=\"h6\" className={classes.title}>\r\n              \r\n            </Typography>\r\n            <Button autoFocus color=\"inherit\" onClick={handleClose}>\r\n              <CloseIcon />\r\n            </Button>\r\n          </Toolbar>\r\n        </AppBar>{\r\n          alertShow?\r\n          <Alert severity=\"error\">\r\n            <AlertTitle>Error</AlertTitle>\r\n            {alertText} <strong>check it out!</strong>\r\n          </Alert>:\"\"\r\n        }\r\n        \r\n        <div className={classes.formDiv}>\r\n          <form className={classes.formClass} noValidate autoComplete=\"off\" onSubmit={save}>\r\n            {props.type === 'edit'?\r\n            <div>\r\n            <TextField \r\n              id=\"id\"\r\n              label=\"id\" \r\n              InputProps={{\r\n                readOnly: true,\r\n              }} \r\n              defaultValue={row.id}\r\n            />\r\n            </div>:\"\"}\r\n            <div>\r\n              <TextField \r\n                id=\"code\" \r\n                label=\"摄像头编号\" \r\n                defaultValue={row.code}\r\n                onChange={formChange}\r\n              />\r\n            </div>\r\n            <div>\r\n              <TextField \r\n                id=\"rtmpAuthCode\" \r\n                label=\"摄像头rtmp权限码\" \r\n                defaultValue={row.rtmpAuthCode}\r\n                onChange={formChange}\r\n              />\r\n            </div>\r\n            {props.type === 'edit'?\"\":\r\n            <div>\r\n              启用状态：\r\n              <Switch\r\n                checked={enabled}\r\n                id=\"enabled\"\r\n                onChange={switchChange}\r\n                color=\"primary\"\r\n                name=\"enabled\"\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n              />\r\n            </div>\r\n            }\r\n            <div>\r\n              录像状态：\r\n              <Switch\r\n                checked={saveVideo}\r\n                id=\"saveVideo\"\r\n                onChange={switchChange}\r\n                color=\"primary\"\r\n                name=\"saveVideo\"\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n              />\r\n            </div>\r\n            <div>\r\n              直播状态：\r\n              <Switch\r\n                checked={live}\r\n                id=\"live\"\r\n                onChange={switchChange}\r\n                color=\"primary\"\r\n                name=\"live\"\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n              />\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport ClickAwayListener from \"@material-ui/core/ClickAwayListener\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport ListIcon from \"@material-ui/icons/List\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport Play from \"./Play\";\r\nimport CameraEdit from \"./CameraEdit\";\r\nimport API from \"../api/Api\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    position: \"relative\",\r\n  },\r\n  dropdown: {\r\n    position: \"absolute\",\r\n    top: 28,\r\n    right: 0,\r\n    left: 0,\r\n    zIndex: 999,\r\n    border: \"0px solid\",\r\n    padding: 1,\r\n    backgroundColor: \"#f8f8f8\",\r\n  },\r\n}));\r\n\r\nexport default function ActionList(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [row, setRow] = React.useState(props.row);\r\n\r\n  const handleClick = () => {\r\n    setOpen((prev) => !prev);\r\n  };\r\n\r\n  const handleClickAway = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const enabled = () => {\r\n    row.enabled = row.enabled === 1 ? 0 : 1;\r\n    API.cameraEnabled(row).then((res) => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack) {\r\n          props.callBack();\r\n        }\r\n        return;\r\n      }\r\n    });\r\n  };\r\n\r\n  const saveVideoChange = () => {\r\n    row.saveVideo = row.saveVideo === 1 ? 0 : 1;\r\n    API.cameraSaveVideoChange(row).then((res) => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack) {\r\n          props.callBack();\r\n        }\r\n        return;\r\n      }\r\n    });\r\n  };\r\n\r\n  const liveChange = () => {\r\n    row.live = row.live === 1 ? 0 : 1;\r\n    API.cameraLiveChange(row).then((res) => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack) {\r\n          props.callBack();\r\n        }\r\n        return;\r\n      }\r\n    });\r\n  };\r\n\r\n  const playAuthcodeReset = () => {\r\n    API.cameraPlayAuthcodeReset(row).then((res) => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack) {\r\n          props.callBack();\r\n        }\r\n        return;\r\n      }\r\n    });\r\n  };\r\n\r\n  let playRef = React.createRef();\r\n  function play() {\r\n    setOpen(false);\r\n    playRef.current.handleClickOpen();\r\n  }\r\n\r\n  let editRef = React.createRef();\r\n  function edit() {\r\n    setOpen(false);\r\n    editRef.current.handleClickOpen();\r\n  }\r\n\r\n  return (\r\n    <ClickAwayListener onClickAway={handleClickAway}>\r\n      <div className={classes.root}>\r\n        <button type=\"button\" onClick={handleClick}>\r\n          <ListIcon />\r\n        </button>\r\n        {open ? (\r\n          <div className={classes.dropdown}>\r\n            <div\r\n              style={{ display: \"flex\", flexDirection: \"column\", gap: \"5px\" }}\r\n            >\r\n              <button onClick={edit}>编辑</button>\r\n              {props.row.enabled === 1 ? (\r\n                <button onClick={enabled}>禁用</button>\r\n              ) : (\r\n                <button onClick={enabled}>启用</button>\r\n              )}\r\n              <button onClick={play}>播放</button>\r\n              <button>\r\n                <NavLink\r\n                  exact\r\n                  to={{\r\n                    pathname: \"/camerashare\",\r\n                    search: \"?cameraId=\" + props.row.id,\r\n                    // hash: \"#camerashare\",\r\n                    state: { row: props.row },\r\n                  }}\r\n                >\r\n                  分享\r\n                </NavLink>\r\n              </button>\r\n              <button onClick={playAuthcodeReset}>重置播放权限码</button>\r\n              {props.row.saveVideo === 1 ? (\r\n                <button onClick={saveVideoChange}>停止录像</button>\r\n              ) : (\r\n                <button onClick={saveVideoChange}>开启录像</button>\r\n              )}\r\n              {props.row.live === 1 ? (\r\n                <button onClick={liveChange}>停止直播</button>\r\n              ) : (\r\n                <button onClick={liveChange}>开启直播</button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n        <Play\r\n          playParam={{\r\n            playMethod: \"permanent\",\r\n            cameraCode: props.row.code,\r\n            authCode: props.row.playAuthCode,\r\n          }}\r\n          onRef={playRef}\r\n        />\r\n        <CameraEdit\r\n          row={props.row}\r\n          type=\"edit\"\r\n          callBack={props.callBack}\r\n          onRef={editRef}\r\n        />\r\n      </div>\r\n    </ClickAwayListener>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport LinkOffIcon from '@material-ui/icons/LinkOff';\r\nimport LinkIcon from '@material-ui/icons/Link';\r\nimport ActionList from './ActionList';\r\nimport CameraEdit from './CameraEdit';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Button from '@material-ui/core/Button';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport API from '../api/Api';\r\n\r\nconst columns = [\r\n  { \r\n    id: 'id',\r\n    label: 'id',\r\n    minWidth: 170\r\n  },\r\n  { \r\n    id: 'code', \r\n    label: '摄像头编号', \r\n    minWidth: 100 \r\n  },\r\n  {\r\n    id: 'rtmpAuthCode',\r\n    label: '摄像头rtmp权限码',\r\n  },\r\n  {\r\n    id: 'playAuthCode',\r\n    label: '播放权限码',\r\n  },\r\n  {\r\n    id: 'onlineStatus',\r\n    label: '在线状态',\r\n    format: (value) => value && value === 1?<LinkIcon/>:<LinkOffIcon/>,\r\n  },\r\n  {\r\n    id: 'enabled',\r\n    label: '启用状态',\r\n    format: (value) => {\r\n      return <Switch\r\n              checked={value === 1}\r\n              id=\"enabled\"\r\n              color=\"primary\"\r\n              name=\"enabled\"\r\n              inputProps={{ 'aria-label': 'primary checkbox' }}\r\n            />\r\n    }\r\n  },\r\n  {\r\n    id: 'live',\r\n    label: '直播状态',\r\n    format: (value) => {\r\n      return <Switch\r\n              checked={value === 1}\r\n              id=\"live\"\r\n              color=\"primary\"\r\n              name=\"live\"\r\n              inputProps={{ 'aria-label': 'primary checkbox' }}\r\n            />\r\n    }\r\n  },\r\n  {\r\n    id: 'saveVideo',\r\n    label: '录像状态',\r\n    format: (value) => {\r\n      return <Switch\r\n              checked={value === 1}\r\n              id=\"saveVideo\"\r\n              color=\"primary\"\r\n              name=\"saveVideo\"\r\n              inputProps={{ 'aria-label': 'primary checkbox' }}\r\n            />\r\n    }\r\n  },\r\n  {\r\n    id: 'action',\r\n    label: '操作',\r\n    minWidth: 100,\r\n    format: (value,row,callBack) => {return <ActionList row={row} callBack={callBack} />},\r\n  },\r\n];\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '100%',\r\n    position: 'relative',\r\n  },\r\n  container: {\r\n    minHeight: 400,\r\n  },\r\n  dropdown: {\r\n    position: 'absolute',\r\n    top: 28,\r\n    right: 0,\r\n    left: 0,\r\n    zIndex: 0,\r\n    border: '0px solid',\r\n    padding: 1,\r\n    backgroundColor: '#f8f8f8',\r\n  },\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n}));\r\n\r\nexport default function CameraList() {\r\n  const classes = useStyles();\r\n  const [page, setPage] = React.useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(10);\r\n  var rows,setRows;\r\n  [rows, setRows] = React.useState([]);\r\n  var editRow = {\r\n    id: \"\",\r\n    code: \"\",\r\n    rtmpAuthCode: \"\",\r\n    playAuthCode: \"\",\r\n    onlineStatus: 0,\r\n    enabled: 1,\r\n    saveVideo: 0,\r\n    live: 1,\r\n  }\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(+event.target.value);\r\n    setPage(0);\r\n  };\r\n\r\n  const getPageList = ()=>{\r\n    API.cameraList()\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        rows.splice(0);\r\n        rows.push(...res.data.page)\r\n        setRows([])\r\n        setRows(rows)\r\n      }\r\n    });\r\n  }\r\n\r\n  let editRef = React.createRef();\r\n  function edit() {\r\n    editRef.current.handleClickOpen();\r\n  }\r\n\r\n  React.useEffect(getPageList,[]) \r\n\r\n  return (\r\n    \r\n    <Paper className={classes.root}>\r\n      <AppBar className={classes.appBar}>\r\n        <Toolbar>\r\n          <Button variant=\"contained\" onClick={edit}>\r\n            创建\r\n          </Button>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            摄像头列表\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <CameraEdit row={editRow} type=\"add\" callBack={getPageList} onRef={editRef}/>\r\n      <TableContainer className={classes.container}>\r\n        <Table stickyHeader aria-label=\"sticky table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              {columns.map((column) => (\r\n                <TableCell\r\n                  key={column.id}\r\n                  align={column.align}\r\n                  style={{ minWidth: column.minWidth }}\r\n                >\r\n                  {column.label}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {rows.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map((row) => {\r\n              return (\r\n                <TableRow hover role=\"checkbox\" tabIndex={-1} key={row.code}>\r\n                  {columns.map((column) => {\r\n                    const value = row[column.id];\r\n                    return (\r\n                      <TableCell key={column.id} align={column.align}>\r\n                        {column.format ? column.format(value,row,getPageList) : value}\r\n                      </TableCell>\r\n                    );\r\n                  })}\r\n                </TableRow>\r\n              );\r\n            })}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <TablePagination\r\n        rowsPerPageOptions={[10, 25, 100]}\r\n        component=\"div\"\r\n        count={rows.length}\r\n        rowsPerPage={rowsPerPage}\r\n        page={page}\r\n        onChangePage={handleChangePage}\r\n        onChangeRowsPerPage={handleChangeRowsPerPage}\r\n      />\r\n    </Paper>\r\n  );\r\n}\r\n","import React, { useImperativeHandle }  from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '100%',\r\n  },\r\n}));\r\n\r\nexport default function CopyAlert(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [title, setTitle] = React.useState(props.dialog.title);\r\n  const [content, setContent] = React.useState(props.dialog.content);\r\n\r\n  //用useImperativeHandle暴露一些外部ref能访问的属性\r\n  useImperativeHandle(props.onRef, () => {\r\n    return {\r\n      handleClickOpen: handleClickOpen,\r\n    };\r\n  });\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Dialog open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\r\n        <DialogTitle id=\"form-dialog-title\">{title}</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            {content}\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleClose} color=\"primary\">\r\n            OK\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useImperativeHandle } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport { Alert, AlertTitle } from '@material-ui/lab';\r\nimport Moment from 'moment'\r\nimport Switch from '@material-ui/core/Switch';\r\nimport API from '../api/Api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n  formClass: {\r\n    '& > *': {\r\n      margin: theme.spacing(1),\r\n      width: '25ch',\r\n    },\r\n  },\r\n  formDiv: {\r\n    margin: '0 auto',\r\n  },\r\n}));\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport default function CameraShareEdit(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [enabled, setEnabled] = React.useState(props.row.enabled === 1?true:false);\r\n  const cameraCode = props.row.cameraCode\r\n  const [row, setRow] = React.useState({\r\n    id: props.row.id,\r\n    cameraId: props.row.cameraId,\r\n    name: props.row.name,\r\n    authCode: props.row.authCode,\r\n    startTime: props.row.startTime?props.row.startTime:Moment(),\r\n    deadline: props.row.deadline?props.row.deadline:Moment().add(7,\"day\"),\r\n    enabled: props.row.enabled,\r\n  });\r\n  const [alertShow, setAlertShow] = React.useState(false);\r\n  const [alertText, setAlertText] = React.useState(\"\");\r\n\r\n  //用useImperativeHandle暴露一些外部ref能访问的属性\r\n  useImperativeHandle(props.onRef, () => {\r\n    return {\r\n      handleClickOpen: handleClickOpen,\r\n    };\r\n  });\r\n\r\n  const handleClickOpen = () => {\r\n    row.id = props.row.id\r\n    row.cameraId = props.row.cameraId\r\n    row.name = props.row.name\r\n    row.authCode = props.row.authCode\r\n    row.startTime = props.row.startTime?props.row.startTime:Moment()\r\n    row.deadline = props.row.deadline?props.row.deadline:Moment().add(7,\"day\")\r\n    row.enabled = props.row.enabled\r\n    setRow(row)\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const save = (data) => {\r\n    API.cameraShareEdit(row)\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack){\r\n          props.callBack()\r\n        }\r\n        return;\r\n      }\r\n      setAlertText(res.msg);\r\n      setAlertShow(true);\r\n      window.setTimeout(function (){\r\n        setAlertShow(false);\r\n      },5000)\r\n    });\r\n  };\r\n\r\n  const deleteCamera = (data) => {\r\n    API.cameraShareDelete(row)\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack){\r\n          props.callBack()\r\n        }\r\n        return;\r\n      }\r\n      setAlertText(res.msg);\r\n      setAlertShow(true);\r\n      window.setTimeout(function (){\r\n        setAlertShow(false);\r\n      },5000)\r\n    });\r\n  };\r\n\r\n  const formChange = (event) => {\r\n    row[event.target.id] = event.target.value\r\n  }\r\n\r\n  const formDateTimeChange = (event) => {\r\n    row[event.target.id] = Moment(event.target.value)\r\n  }\r\n\r\n  const switchChange = (event) => {\r\n    console.log(event.target.checked)\r\n    row[event.target.id] = event.target.checked?1:0\r\n    if(event.target.id===\"enabled\"){\r\n      setEnabled(event.target.checked)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Dialog fullScreen open={open} onClose={handleClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar}>\r\n          <Toolbar>\r\n            <Button variant=\"contained\" onClick={save}>\r\n              保存 \r\n            </Button>\r\n            <span>&nbsp;&nbsp;</span>\r\n            {props.type === 'edit'?\r\n              <Button variant=\"contained\" onClick={deleteCamera}>\r\n                删除\r\n              </Button>:\"\"\r\n            }       \r\n            <Typography variant=\"h6\" className={classes.title}>\r\n            <div>{row.name?row.name+' 分享编辑':'创建分享'} </div>\r\n            </Typography>\r\n            <Button autoFocus color=\"inherit\" onClick={handleClose}>\r\n              <CloseIcon />\r\n            </Button>\r\n          </Toolbar>\r\n        </AppBar>{\r\n          alertShow?\r\n          <Alert severity=\"error\">\r\n            <AlertTitle>Error</AlertTitle>\r\n            {alertText} <strong>check it out!</strong>\r\n          </Alert>:\"\"\r\n        }\r\n        \r\n        <div className={classes.formDiv}>\r\n          \r\n          <form className={classes.formClass} noValidate autoComplete=\"off\" onSubmit={save}>\r\n            {props.type === 'edit'?\r\n            <div>\r\n            <TextField \r\n              id=\"id\"\r\n              label=\"id\" \r\n              InputProps={{\r\n                readOnly: true,\r\n              }} \r\n              defaultValue={row.id}\r\n            />\r\n            </div>:\"\"}\r\n            <div>\r\n              <TextField \r\n                id=\"name\" \r\n                label=\"分享名称\" \r\n                defaultValue={row.name}\r\n                onChange={formChange}\r\n              />\r\n            </div>\r\n            {/* <div>\r\n              <TextField \r\n                id=\"authCode\" \r\n                label=\"authCode\" \r\n                defaultValue={row.authCode}\r\n                onChange={formChange}\r\n              />\r\n            </div> */}\r\n            <div>\r\n              <TextField\r\n                id=\"startTime\"\r\n                label=\"开始时间\"\r\n                type=\"datetime-local\"\r\n                defaultValue={row.startTime?Moment(row.startTime).format(\"YYYY-MM-DDTHH:mm\"):Moment().format(\"YYYY-MM-DDTHH:mm\")}\r\n                // className={classes.textField}\r\n                InputLabelProps={{\r\n                  shrink: true,\r\n                }}\r\n                onChange={formDateTimeChange}\r\n              />\r\n            </div>\r\n            <div>\r\n              <TextField\r\n                id=\"deadline\"\r\n                label=\"截止日期\"\r\n                type=\"datetime-local\"\r\n                defaultValue={row.deadline?Moment(row.deadline).format(\"YYYY-MM-DDTHH:mm\"):Moment().add(7,\"day\").format(\"YYYY-MM-DDTHH:mm\")}\r\n                // className={classes.textField}\r\n                InputLabelProps={{\r\n                  shrink: true,\r\n                }}\r\n                onChange={formDateTimeChange}\r\n              />\r\n            </div>\r\n            {props.type === 'edit'?\"\":\r\n            <div>\r\n              <Switch\r\n                checked={enabled}\r\n                id=\"enabled\"\r\n                onChange={switchChange}\r\n                color=\"primary\"\r\n                name=\"enabled\"\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n              />\r\n            </div>\r\n            }\r\n          </form>\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport Copy from 'copy-to-clipboard';\r\nimport CopyAlert from './CopyAlert'\r\nimport Play from '../camera/Play';\r\nimport CameraEdit from './CameraShareEdit';\r\nimport API from '../api/Api';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    position: 'relative',\r\n  }, \r\n  dropdown: {\r\n    position: 'absolute',\r\n    top: 28,\r\n    right: 0,\r\n    left: 0, \r\n    zIndex: 999,\r\n    border: '0px solid',\r\n    padding: 1,\r\n    backgroundColor: '#f8f8f8',\r\n  },\r\n}));\r\n\r\nexport default function ActionList(props) {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [dialogObj, setDialogObj] = React.useState({title:\"Success\",content:\"copy success !\"});\r\n  const [row,setRow] = React.useState(props.row);\r\n\r\n  const handleClick = () => {\r\n    setOpen((prev) => !prev);\r\n  };\r\n\r\n  const handleClickAway = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const enabled=() => {\r\n    row.enabled = row.enabled === 1?0:1\r\n    API.cameraShareEnabled(row)\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        setOpen(false);\r\n        if (props.callBack){\r\n          props.callBack()\r\n        }\r\n        return;\r\n      }\r\n    });\r\n  }\r\n\r\n  let playRef = React.createRef();\r\n  function play() {\r\n    setOpen(false);\r\n    setRow(props.row)\r\n    playRef.current.handleClickOpen();\r\n  }\r\n\r\n  let editRef = React.createRef();\r\n  function edit() {\r\n    setOpen(false);\r\n    editRef.current.handleClickOpen();\r\n  }\r\n\r\n  let copyRef = React.createRef();\r\n  function share() {\r\n    setOpen(false);\r\n    let sURL = window.location.origin+window.location.pathname+\"#/live?method=temp&code=\"+props.row.cameraCode+\"&authCode=\"+props.row.authCode\r\n    Copy(sURL);\r\n    copyRef.current.handleClickOpen();\r\n  }\r\n\r\n  return (\r\n    <ClickAwayListener onClickAway={handleClickAway}>\r\n      <div className={classes.root}>\r\n        <button type=\"button\" onClick={handleClick}>\r\n          <ListIcon />\r\n        </button>\r\n        {open ? (\r\n          <div className={classes.dropdown}>\r\n            <List component=\"nav\" aria-label=\"secondary mailbox folders\">\r\n              <ListItem button>\r\n                <ListItemText primary=\"编辑\" onClick={edit}/>\r\n              </ListItem>\r\n              <ListItem button onClick={enabled}>\r\n                {\r\n                  props.row.enabled === 1?\r\n                  <ListItemText primary=\"禁用\" />:<ListItemText primary=\"启用\" />\r\n                }\r\n              </ListItem>\r\n              <ListItem button onClick={play}>\r\n                <ListItemText primary=\"播放\" />\r\n              </ListItem>\r\n              <ListItem button onClick={share}>\r\n                <ListItemText primary=\"分享\" />\r\n              </ListItem>\r\n            </List>\r\n          </div>\r\n        ) : null}\r\n        <Play playParam={ {playMethod:\"temp\",cameraCode:row.cameraCode,authCode:row.authCode } } onRef={playRef}/>\r\n        <CameraEdit row={props.row} type=\"edit\" callBack={props.callBack} onRef={editRef}/>\r\n        <CopyAlert dialog={dialogObj} onRef={copyRef}/>\r\n      </div>\r\n    </ClickAwayListener>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport {NavLink} from 'react-router-dom'\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Button from '@material-ui/core/Button';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport Moment from 'moment'\r\nimport ActionList from './ActionList';\r\nimport CameraShareEdit from './CameraShareEdit';\r\nimport API from '../api/Api';\r\n\r\nconst columns = [\r\n  { \r\n    id: 'id',\r\n    label: 'id',\r\n    minWidth: 170\r\n  },\r\n  {\r\n    id: 'name',\r\n    label: '分享名称',\r\n  },\r\n  {\r\n    id: 'authCode',\r\n    label: '权限码',\r\n  },\r\n  {\r\n    id: 'startTime',\r\n    label: '开始时间',\r\n    format: (value) => {\r\n        let offset = new Date().getTimezoneOffset()\r\n        return value?Moment(value).format(\"YYYY-MM-DD HH:mm\"):\"---\"\r\n    }\r\n  },\r\n  {\r\n    id: 'deadline',\r\n    label: '截止时间',\r\n    format: (value) => {\r\n      let offset = new Date().getTimezoneOffset()\r\n        return value?Moment(value).format(\"YYYY-MM-DD HH:mm\"):\"---\"\r\n    }\r\n  },\r\n  {\r\n    id: 'enabled',\r\n    label: '启用状态',\r\n    format: (value) => {\r\n      return <Switch\r\n              checked={value === 1}\r\n              id=\"enabled\"\r\n              color=\"primary\"\r\n              name=\"enabled\"\r\n              inputProps={{ 'aria-label': 'primary checkbox' }}\r\n            />\r\n    }\r\n  },\r\n  {\r\n    id: 'action',\r\n    label: '操作',\r\n    format: (value,row,camera,callBack) => {\r\n      row.cameraId = camera.id\r\n      row.cameraCode = camera.code\r\n      return <ActionList row={row} callBack={callBack} />},\r\n  },\r\n];\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '100%',\r\n    position: 'relative',\r\n  },\r\n  container: {\r\n    minHeight: 400,\r\n  },\r\n  dropdown: {\r\n    position: 'absolute',\r\n    top: 28,\r\n    right: 0,\r\n    left: 0,\r\n    zIndex: 0,\r\n    border: '0px solid',\r\n    padding: 1,\r\n    backgroundColor: '#f8f8f8',\r\n  },\r\n  appBar: {\r\n    position: 'relative',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n}));\r\n\r\nexport default function CameraShareList(props) {\r\n  const classes = useStyles();\r\n  const [page, setPage] = React.useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(10);\r\n  const [rows,setRows]  = React.useState([]);\r\n  const [editRow,setEditRow]  = React.useState({\r\n    id: \"\",\r\n    cameraId: \"\",\r\n    cameraCode: \"\",\r\n    name: \"\",\r\n    authCode: \"\",\r\n    enabled: 1,\r\n    startTime: \"\",\r\n    deadline: \"\",\r\n  });\r\n  const [camera,setCamera] = React.useState({})\r\n\r\n  const getQueryString = (name) => {\r\n    let reg = new RegExp(\"(^|&|\\\\?)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n    let r = window.location.hash.substr(1).match(reg);\r\n    if (r != null) {\r\n        return decodeURIComponent(r[2]);\r\n    };\r\n    return null;\r\n  }\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(+event.target.value);\r\n    setPage(0);\r\n  };\r\n\r\n  const getPageList = ()=>{\r\n    let cameraId = getQueryString(\"cameraId\")\r\n    API.cameraDetail({id:cameraId})\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        let camera = res.data\r\n        if (!camera){\r\n          return\r\n        }\r\n        setCamera(camera)\r\n        let editRowNew = editRow\r\n        editRowNew.cameraId = camera.id\r\n        editRowNew.cameraCode = camera.code\r\n        setEditRow(editRowNew)\r\n        API.cameraShareList({cameraId:camera.id})\r\n        .then(res => {\r\n          if (res.code === 1) {\r\n            rows.splice(0);\r\n            rows.push(...res.data.page)\r\n            setRows([])\r\n            setRows(rows)\r\n          }\r\n        });\r\n      }\r\n    });\r\n    \r\n  }\r\n\r\n  let editRef = React.createRef();\r\n  function edit() {\r\n    setEditRow({})\r\n    setEditRow(editRow)\r\n    editRef.current.handleClickOpen();\r\n  }\r\n\r\n  React.useEffect(getPageList,[]) \r\n\r\n  return (\r\n    \r\n    <Paper className={classes.root}>\r\n      <AppBar className={classes.appBar}>\r\n        <Toolbar>\r\n          <Button variant=\"contained\" onClick={edit}>\r\n            创建\r\n          </Button>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n          摄像头: {camera.code?camera.code:'--'} 分享列表\r\n          </Typography>\r\n          <Button variant=\"contained\">\r\n            <NavLink exact to={{\r\n              pathname: \"/\",\r\n              // search: \"?sort=name\",\r\n              // hash: \"#camerashare\",\r\n              state: { }\r\n            }}>返回</NavLink>\r\n          </Button>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <CameraShareEdit row={editRow} type=\"add\" callBack={getPageList} onRef={editRef}/>\r\n      <TableContainer className={classes.container}>\r\n        <Table stickyHeader aria-label=\"sticky table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              {columns.map((column) => (\r\n                <TableCell\r\n                  key={column.id}\r\n                  align={column.align}\r\n                  style={{ minWidth: column.minWidth }}\r\n                >\r\n                  {column.label}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {rows.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map((row) => {\r\n              return (\r\n                <TableRow hover role=\"checkbox\" tabIndex={-1} key={row.id}>\r\n                  {columns.map((column) => {\r\n                    const value = row[column.id];\r\n                    return (\r\n                      <TableCell key={column.id} align={column.align}>\r\n                        {column.format ? column.format(value,row,camera,getPageList) : value}\r\n                      </TableCell>\r\n                    );\r\n                  })}\r\n                </TableRow>\r\n              );\r\n            })}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <TablePagination\r\n        rowsPerPageOptions={[10, 25, 100]}\r\n        component=\"div\"\r\n        count={rows.length}\r\n        rowsPerPage={rowsPerPage}\r\n        page={page}\r\n        onChangePage={handleChangePage}\r\n        onChangeRowsPerPage={handleChangeRowsPerPage}\r\n      />\r\n    </Paper>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Link from '@material-ui/core/Link';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Box from '@material-ui/core/Box';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { Alert, AlertTitle } from '@material-ui/lab';\r\nimport API from '../api/Api';\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright © '}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        Your Website\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100vh',\r\n  },\r\n  image: {\r\n    backgroundImage: 'url(https://source.unsplash.com/random)',\r\n    backgroundRepeat: 'no-repeat',\r\n    backgroundColor:\r\n      theme.palette.type === 'light' ? theme.palette.grey[50] : theme.palette.grey[900],\r\n    backgroundSize: 'cover',\r\n    backgroundPosition: 'center',\r\n  },\r\n  paper: {\r\n    margin: theme.spacing(8, 4),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}));\r\n\r\nexport default function SignInSide() {\r\n  const classes = useStyles();\r\n  const [user, setUser] = React.useState({userName:\"\",password:\"\"});\r\n  const [alertShow, setAlertShow] = React.useState(false);\r\n  const [alertText, setAlertText] = React.useState(\"\");\r\n\r\n  const onLoad = () =>{\r\n    if ( window.localStorage.getItem(\"tokenExpired\") === \"true\"){\r\n      localStorage.setItem(\"tokenExpired\", \"false\");\r\n    }\r\n  }\r\n\r\n  const login = (event) => {\r\n    API.login(user)\r\n    .then(res => {\r\n      if (res.code === 1) {\r\n        let localStorage = window.localStorage\r\n        localStorage.setItem(\"token\",res.data.token)\r\n        localStorage.setItem(\"tokenExpired\", \"false\");\r\n        window.location.hash = \"#/\" \r\n        return;\r\n      }\r\n      setAlertText(res.msg);\r\n      setAlertShow(true);\r\n    });\r\n  }\r\n\r\n  const formChange = (event) => {\r\n    user[event.target.id] = event.target.value\r\n  }\r\n\r\n  React.useEffect(onLoad,[]) \r\n\r\n  return (\r\n    <Grid container component=\"main\" className={classes.root}>\r\n      <CssBaseline />\r\n      <Grid item xs={false} sm={4} md={7} className={classes.image} />\r\n      <Grid item xs={12} sm={8} md={5} component={Paper} elevation={6} square>\r\n        <div className={classes.paper}>\r\n          <Avatar className={classes.avatar}>\r\n            <LockOutlinedIcon />\r\n          </Avatar>\r\n          <Typography component=\"h1\" variant=\"h5\">\r\n            Sign in\r\n          </Typography>\r\n          {\r\n          alertShow?\r\n          <Alert severity=\"error\">\r\n            <AlertTitle>Error</AlertTitle>\r\n            {alertText} <strong>check it out!</strong>\r\n          </Alert>:\"\"\r\n        }\r\n          <form className={classes.form} noValidate>\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"userName\"\r\n              label=\"UserName\"\r\n              name=\"userName\"\r\n              autoComplete=\"userName\"\r\n              autoFocus\r\n              onChange={formChange}\r\n            />\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              name=\"password\"\r\n              label=\"Password\"\r\n              type=\"password\"\r\n              id=\"password\"\r\n              autoComplete=\"current-password\"\r\n              onChange={formChange}\r\n            />\r\n            <FormControlLabel\r\n              control={<Checkbox value=\"remember\" color=\"primary\" />}\r\n              label=\"Remember me\"\r\n            />\r\n            <Button\r\n              fullWidth\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              className={classes.submit}\r\n              onClick={login}\r\n            >\r\n              Sign In\r\n            </Button>\r\n            <Grid container>\r\n              <Grid item xs>\r\n                <Link href=\"#\" variant=\"body2\">\r\n                  Forgot password?\r\n                </Link>\r\n              </Grid>\r\n              <Grid item>\r\n                <Link href=\"#\" variant=\"body2\">\r\n                  {\"Don't have an account? Sign Up\"}\r\n                </Link>\r\n              </Grid>\r\n            </Grid>\r\n            <Box mt={5}>\r\n              <Copyright />\r\n            </Box>\r\n          </form>\r\n        </div>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default class error extends React.Component{\r\n    render(){\r\n        return(\r\n            <h2>404</h2>\r\n        );\r\n    }\r\n}","import React, { useImperativeHandle } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport Flv from 'flv.js';\r\nimport API from '../api/Api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: 'relative',\r\n    backgroundColor: '#eebbaa',\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n  videoContainer: {\r\n    width: '90%',\r\n    margin: '0 auto'\r\n  },\r\n}));\r\n\r\nexport default function Play(props) {\r\n  const classes = useStyles();\r\n  const [audio, setAudio] = React.useState(true);\r\n  var player = null;\r\n  var lastDecodedFrame = 0\r\n\r\n  const switchChange = (event) => {\r\n    setAudio(event.target.checked)\r\n  }\r\n\r\n  const getQueryString = (name) => {\r\n    let reg = new RegExp(\"(^|&|\\\\?)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n    let r = window.location.hash.substr(1).match(reg);\r\n    if (r != null) {\r\n        return decodeURIComponent(r[2]);\r\n    };\r\n    return null;\r\n  }\r\n\r\n  const flv_load = (val) => {\r\n    let method = getQueryString(\"method\");\r\n    let code = getQueryString(\"code\");\r\n    let authCode = getQueryString(\"authCode\");\r\n    if(!method || !code || !authCode){\r\n      return\r\n    }\r\n    var mediaDataSource = {\r\n      type: 'flv'\r\n    };\r\n    let videoUrl = API.flvURL+\"/live/\"+method+\"/\"+code+\"/\"+authCode+\".flv\";\r\n    // let videoUrl = window.origin.substring(0,window.origin.lastIndexOf(\":\"))+\":9091/live/\"+method+\"/\"+code+\"/\"+authCode+\".flv\";\r\n    mediaDataSource['url'] = videoUrl;\r\n    mediaDataSource['hasAudio'] = audio;\r\n    mediaDataSource['isLive'] = true;\r\n    console.log('MediaDataSource', mediaDataSource);\r\n    flv_load_mds(mediaDataSource);\r\n  }\r\n\r\n  const flv_load_mds = (mediaDataSource) => {\r\n      var element = document.getElementsByClassName('centeredVideo')[0];\r\n    \r\n      if (typeof player !== \"undefined\") {\r\n          if (player != null) {\r\n            player.pause();\r\n            player.unload();\r\n            player.detachMediaElement();\r\n            player.destroy();\r\n            player= null;\r\n          }\r\n      }\r\n      \r\n      player = Flv.createPlayer(mediaDataSource, {\r\n          enableWorker: false,\r\n          lazyLoadMaxDuration: 3 * 60,\r\n          seekType: 'range',\r\n      });\r\n      player.on(Flv.Events.ERROR, (errorType, errorDetail, errorInfo) => {\r\n        console.log(\"errorType:\", errorType);\r\n        console.log(\"errorDetail:\", errorDetail);\r\n        console.log(\"errorInfo:\", errorInfo);\r\n        //视频出错后销毁重新创建\r\n        if (player) {\r\n          player.pause();\r\n          player.unload();\r\n          player.detachMediaElement();\r\n          player.destroy();\r\n          player= null;\r\n          window.setTimeout(flv_load,500)\r\n        }\r\n      });\r\n      //画面卡死\r\n      player.on(Flv.Events.STATISTICS_INFO, function (res) {\r\n        if (lastDecodedFrame == 0) {\r\n          lastDecodedFrame = res.decodedFrames;\r\n          return;\r\n        }\r\n        if (lastDecodedFrame != res.decodedFrames) {\r\n          lastDecodedFrame = res.decodedFrames;\r\n        } else {\r\n            console.log(\"decodedFrames:\", res.decodedFrames)\r\n            lastDecodedFrame = 0;\r\n            if (player) {\r\n              player.pause();\r\n              player.unload();\r\n              player.detachMediaElement();\r\n              player.destroy();\r\n              player= null;\r\n              window.setTimeout(flv_load,500)\r\n          }\r\n        }\r\n      });\r\n      player.attachMediaElement(element);\r\n      player.load();\r\n      player.play()\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <AppBar className={classes.appBar}>\r\n          <Toolbar>\r\n            <Button variant=\"contained\" onClick={flv_load}>\r\n              play\r\n            </Button>\r\n            <Typography variant=\"h6\" className={classes.title}>\r\n            hasAudio\r\n              <Switch\r\n                checked={audio}\r\n                id=\"Audio\"\r\n                color=\"primary\"\r\n                name=\"hasAudio\"\r\n                onChange={switchChange}\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n              />\r\n            </Typography>\r\n            {/* <Button autoFocus color=\"inherit\">\r\n              <CloseIcon />\r\n            </Button> */}\r\n          </Toolbar>\r\n        </AppBar>\r\n        <div className={classes.videoContainer}>\r\n            <div>\r\n                <video name=\"videoElement\" className=\"centeredVideo\" controls allow=\"autoPlay\" width=\"100%\" >\r\n                    Your browser is too old which doesn't support HTML5 video.\r\n                </video>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { memo } from \"react\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\nimport CameraList from '../camera/CameraList';\r\nimport CameraShareList from '../camerashare/CameraShareList';\r\nimport SignInSide from '../login/SignInSide';\r\nimport NoMatch from '../404/NoMatch';\r\nimport Live from '../camera/Live';\r\n\r\nfunction Routing(props) {\r\n    return (\r\n      <Switch>\r\n        <Route exact path=\"/\" component={CameraList} />\r\n        <Route exact path=\"/camerashare\" component={CameraShareList} />\r\n        <Route exact path=\"/live\" component={Live} /> \r\n        <Route path=\"/login\" component={SignInSide} />\r\n        <Route component={NoMatch} />\r\n      </Switch>\r\n    );\r\n  }\r\n  \r\n  export default memo(Routing);\r\n","import { HashRouter } from \"react-router-dom\";\r\nimport Routing from './route/Routing';\r\n\r\nfunction Rtmp2flv() {\r\n  return (\r\n    <div>\r\n        <HashRouter>\r\n            <Routing/>\r\n        </HashRouter>\r\n    </div>\r\n  );\r\n} \r\n\r\nexport default Rtmp2flv;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Rtmp2flv from './Rtmp2flv';\r\n\r\nfunction App() {\r\n  return (\r\n    <Rtmp2flv />\r\n  );\r\n}\r\n\r\nReactDOM.render(<App />, document.querySelector('#app'));"],"sourceRoot":""}